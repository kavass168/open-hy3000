/dts-v1/;

#include "mt7981.dtsi"

/ {
    model = "SL3000 (MT7981, 3LAN+1WAN)";
    compatible = "sl,sl3000-emmc", "mediatek,mt7981";

    aliases {
        ethernet0 = &gmac0;
        ethernet1 = &gmac1;
    };

    chosen {
        bootargs = "console=ttyS0,115200n8";
    };

    memory@40000000 {
        device_type = "memory";
        reg = <0x40000000 0x20000000>;
    };
};

/* EMMC */
&mmc0 {
    bus-width = <8>;
    max-frequency = <52000000>;
    cap-mmc-highspeed;
    vmmc-supply = <&reg_3p3v>;
    status = "okay";
};

/* GMAC0 → WAN */
&gmac0 {
    status = "okay";
    phy-mode = "sgmii";
    mediatek,sgmii = <1>;
    fixed-link {
        speed = <1000>;
        full-duplex;
    };
};

/* GMAC1 → Switch (MT7531) */
&gmac1 {
    status = "okay";
    phy-mode = "sgmii";
    mediatek,sgmii = <2>;
    fixed-link {
        speed = <1000>;
        full-duplex;
    };
};

/* MDIO + MT7531 Switch */
&mdio_bus {
    status = "okay";

    switch@0 {
        compatible = "mediatek,mt7531";
        reg = <0>;

        ports {
            #address-cells = <1>;
            #size-cells = <0>;

            port@0 {
                reg = <0>;
                label = "wan";
                ethernet = <&gmac0>;
            };

            port@1 {
                reg = <1>;
                label = "lan1";
            };

            port@2 {
                reg = <2>;
                label = "lan2";
            };

            port@3 {
                reg = <3>;
                label = "lan3";
            };

            port@6 {
                reg = <6>;
                label = "cpu";
                ethernet = <&gmac1>;
                phy-mode = "sgmii";
            };
        };
    };
};
